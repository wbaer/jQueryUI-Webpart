{"version":3,"sources":["sudoSync.ts"],"names":[],"mappings":";AACA,IAAM,IAAI,GAAoE,OAAO,CAAC,MAAM,CAAC,CAAC;AAC9F,IAAM,OAAO,GAAoC,OAAO,CAAC,SAAS,CAAC,CAAC;AAQpE,qBAA4B,MAAgB;IAC1C,IAAM,UAAU,GAA+B,IAAI,CAAC,MAAM,EACN;QACE,aAAa,EAAE,KAAK;QACpB,MAAM,EAAE,uBAAuB;KAChC,CAAC,CAAC;IAEvD,IAAM,MAAM,GAAa,EAAE,CAAC;IAC5B,UAAU,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,EAAE,UAAC,IAAY;QACxC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;IAC/B,CAAC,CAAC,CAAC;IAEH,IAAM,MAAM,GAAa,EAAE,CAAC;IAC5B,UAAU,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,EAAE,UAAC,IAAY;QACxC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;IAC/B,CAAC,CAAC,CAAC;IAEH,IAAI,IAAI,GAAW,SAAS,CAAC;IAC7B,UAAU,CAAC,EAAE,CAAC,OAAO,EAAE,UAAC,QAAgB;QACtC,IAAI,GAAG,QAAQ,CAAC;IAClB,CAAC,CAAC,CAAC;IAEH,0FAA0F;IAC1F,OAAO,IAAI,KAAK,SAAS,EAAE,CAAC;QAC1B,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACrB,CAAC;IAED,MAAM,CAAC,EAAE,IAAI,MAAA,EAAE,MAAM,QAAA,EAAE,MAAM,QAAA,EAAE,CAAC;AAClC,CAAC;AA5BD,kCA4BC","file":"sudoSync.js","sourcesContent":["import * as child_process from 'child_process';\r\nconst sudo: (args: string[], options: Object) => child_process.ChildProcess = require('sudo');\r\nconst deasync: { sleep: (ms: number) => void } = require('deasync');\r\n\r\nexport interface ISudoSyncResult {\r\n  stdout: string[];\r\n  stderr: string[];\r\n  code: number;\r\n}\r\n\r\nexport function runSudoSync(params: string[]): ISudoSyncResult {\r\n  const sudoResult: child_process.ChildProcess = sudo(params,\r\n                                                      {\r\n                                                        cachePassword: false,\r\n                                                        prompt: 'Enter your password: '\r\n                                                      });\r\n\r\n  const stderr: string[] = [];\r\n  sudoResult.stderr.on('data', (data: Buffer) => {\r\n    stderr.push(data.toString());\r\n  });\r\n\r\n  const stdout: string[] = [];\r\n  sudoResult.stdout.on('data', (data: Buffer) => {\r\n    stdout.push(data.toString());\r\n  });\r\n\r\n  let code: number = undefined;\r\n  sudoResult.on('close', (exitCode: number) => {\r\n    code = exitCode;\r\n  });\r\n\r\n  // Because we're running with sudo, we can't run synchronously, so synchronize by polling.\r\n  while (code === undefined) {\r\n    deasync.sleep(100);\r\n  }\r\n\r\n  return { code, stdout, stderr };\r\n}"],"sourceRoot":"..\\src"}