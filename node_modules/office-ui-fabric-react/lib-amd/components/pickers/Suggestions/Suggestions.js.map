{"version":3,"sources":["components/pickers/Suggestions/Suggestions.tsx"],"names":[],"mappings":"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","file":"components/pickers/Suggestions/Suggestions.js","sourcesContent":["import * as React from 'react';\r\nimport {\r\n  BaseComponent,\r\n  css\r\n} from '../../../Utilities';\r\nimport { DefaultButton, ButtonType } from '../../../Button';\r\nimport { Spinner } from '../../../Spinner';\r\nimport { ISuggestionItemProps, ISuggestionsProps } from './Suggestions.Props';\r\nimport './Suggestions.scss';\r\n\r\nexport class SuggestionsItem<T> extends React.Component<ISuggestionItemProps<T>, {}> {\r\n  public render() {\r\n    let {\r\n      suggestionModel,\r\n      RenderSuggestion,\r\n      onClick,\r\n      className\r\n    } = this.props;\r\n    return (\r\n      <DefaultButton\r\n        onClick={ onClick }\r\n        className={ css('ms-Suggestions-item', { 'is-suggested': suggestionModel.selected }, className) }\r\n      >\r\n        <RenderSuggestion { ...suggestionModel.item } />\r\n      </DefaultButton>\r\n    );\r\n  }\r\n}\r\n\r\nexport class Suggestions<T> extends BaseComponent<ISuggestionsProps<T>, {}> {\r\n\r\n  protected _searchForMoreButton: DefaultButton;\r\n  protected _selectedElement: HTMLDivElement;\r\n  private SuggestionsItemOfProperType = SuggestionsItem as new (props: ISuggestionItemProps<T>) => SuggestionsItem<T>;\r\n\r\n  constructor(suggestionsProps: ISuggestionsProps<T>) {\r\n    super(suggestionsProps);\r\n    this._getMoreResults = this._getMoreResults.bind(this);\r\n  }\r\n\r\n  public componentDidUpdate() {\r\n    this.scrollSelected();\r\n  }\r\n\r\n  public render() {\r\n    let {\r\n      suggestionsHeaderText,\r\n      searchForMoreText,\r\n      className,\r\n      moreSuggestionsAvailable,\r\n      noResultsFoundText,\r\n      suggestions,\r\n      isLoading,\r\n      loadingText,\r\n      onRenderNoResultFound,\r\n    } = this.props;\r\n\r\n    let noResults: () => JSX.Element = () => {\r\n      return noResultsFoundText ?\r\n        <div className='ms-Suggestions-none'>\r\n          { noResultsFoundText }\r\n        </div> : null;\r\n    };\r\n\r\n    return (\r\n      <div className={ css('ms-Suggestions', className ? className : '') }>\r\n        { suggestionsHeaderText ?\r\n          (<div className='ms-Suggestions-title'>\r\n            { suggestionsHeaderText }\r\n          </div>) : (null) }\r\n        { isLoading && (\r\n          <Spinner\r\n            className='ms-Suggestions-spinner'\r\n            label={ loadingText }\r\n          />) }\r\n        { (!suggestions || !suggestions.length) && !isLoading ?\r\n          (onRenderNoResultFound ? onRenderNoResultFound(null, noResults) : noResults()) :\r\n          this._renderSuggestions()\r\n        }\r\n        { searchForMoreText && moreSuggestionsAvailable ?\r\n          (<DefaultButton\r\n            onClick={ this._getMoreResults.bind(this) }\r\n            className={ 'ms-SearchMore-button' }\r\n            buttonType={ ButtonType.icon }\r\n            icon={ 'Search' }\r\n            ref={ this._resolveRef('_searchForMoreButton') } >\r\n            { searchForMoreText }\r\n          </DefaultButton>) : (null)\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  public focusSearchForMoreButton() {\r\n    if (this._searchForMoreButton) {\r\n      this._searchForMoreButton.focus();\r\n    }\r\n  }\r\n\r\n  // TODO get the element to scroll into view properly regardless of direction.\r\n  public scrollSelected() {\r\n    if (this._selectedElement) {\r\n      this._selectedElement.scrollIntoView(false);\r\n    }\r\n  }\r\n\r\n  private _renderSuggestions(): JSX.Element {\r\n    let {\r\n      suggestions,\r\n      onRenderSuggestion,\r\n      suggestionsItemClassName } = this.props;\r\n    let TypedSuggestionsItem = this.SuggestionsItemOfProperType;\r\n\r\n    return (\r\n      <div className='ms-Suggestions-container' id='suggestion-list' role='menu'>\r\n        { suggestions.map((suggestion, index) =>\r\n          <div ref={ this._resolveRef(suggestion.selected ? '_selectedElement' : '') }\r\n            key={ index }\r\n            id={ 'sug-' + index }\r\n            role='menuitem'>\r\n            <TypedSuggestionsItem\r\n              suggestionModel={ suggestion }\r\n              RenderSuggestion={ onRenderSuggestion }\r\n              onClick={ (ev: React.MouseEvent<HTMLElement>) => this.props.onSuggestionClick(ev, suggestion.item, index) }\r\n              className={ suggestionsItemClassName }\r\n            />\r\n          </div>) }\r\n      </div>);\r\n  }\r\n\r\n  private _getMoreResults() {\r\n    if (this.props.onGetMoreResults) {\r\n      this.props.onGetMoreResults();\r\n    }\r\n  }\r\n\r\n}"],"sourceRoot":"..\\..\\..\\..\\src"}