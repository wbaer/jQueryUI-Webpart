"use strict";
var sp_telemetry_1 = require("@ms/sp-telemetry");
var QuillLoader = (function () {
    function QuillLoader() {
    }
    QuillLoader.prototype.loadModule = function () {
        if (!QuillLoader._quillPromise) {
            QuillLoader._quillPromise = new Promise(function (complete) {
                require.ensure(['quill'], function (require) {
                    var quill = require('quill');
                    QuillLoader._quillModule = quill;
                    complete(quill);
                }, 'sp-client-preview-quill');
            });
            QuillLoader._quillPromise.catch(function (error) {
                sp_telemetry_1._TraceLogger.logError(QuillLoader.logSource, error);
            });
        }
        return QuillLoader._quillPromise;
    };
    return QuillLoader;
}());
QuillLoader.logSource = sp_telemetry_1._LogSource.create('SPRteQuillLoader');
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = QuillLoader;
