{
  "id": "clientSideApplicationManifestSchema.json",
  "title": "Client-side application manifest",
  "description": "A client-side application is the architectural component that manages the appearance and behavior of an entire web page.",

  "type": "object",
  "allOf": [
    {
      "type": "object",
      "properties": {
        "$schema": { "type": "string" },

        "manifestVersion": { "$ref": "anyValue.json" },
        "id": { "$ref": "anyValue.json" },
        "alias": { "$ref": "anyValue.json" },
        "version": { "$ref": "anyValue.json" },
        "loaderConfig": { "$ref": "anyValue.json" },
        "componentType": { "$ref": "anyValue.json" },
        "preloadOptions": { "$ref": "anyValue.json" },
        "title": { "$ref": "anyValue.json" },
        "description": { "$ref": "anyValue.json" },
        "preloadComponents": { "$ref": "anyValue.json" }
      },
      "additionalProperties": false
    },
    {
      "$ref": "clientSideComponentManifestSchema.json#/definitions/clientSideComponentManifest"
    },
    {
      "type": "object",
      "required": [
        "preloadOptions",
        "componentType",
        "title",
        "description"
      ],
      "properties": {
        "componentType": {
          "type": "string",
          "enum": [
            "Application"
          ]
        },

        "preloadOptions": {
          "title": "Preload Options",
          "description": "Represents flags to preload information in host aspx page.",
          "type": "object",
          "properties": {
            "shouldPreloadWeb": {
              "title": "Should Preload Web",
              "description": "A value indicating whether or not to preload the web object when loading the application page. If not present, defaults to false.",
              "type": "boolean"
            },

            "shouldPreloadUser": {
              "title": "Should Preload User",
              "description": "A value indicating whether or not to preload the user object when loading the application page. If not present, defaults to false.",
              "type": "boolean"
            },

            "shouldPreloadList": {
              "title": "Should Preload List",
              "description": "A value indicating whether or not to preload the list object when loading the application page. If not present, defaults to false.",
              "type": "boolean"
            },

            "shouldPreloadItem": {
              "title": "Should Preload List Item",
              "description": "A value indicating whether or not to preload the list item object when loading the application page. If not present, defaults to false.",
              "type": "boolean"
            },

            "shouldPreloadQuickLaunch": {
              "title": "Should Preload Quick Launch",
              "description": "A value indicating whether or not to preload the quick launch navigation menu items when loading the application page. If not present, defaults to false.",
              "type": "boolean"
            },

            "preloadListItemQueryOption": {
              "title": "Preload List Item Query Options",
              "description": "This specifies an optional OData query expression with the syntax that would be used in the URL query parameter for a REST API call that fetches a SharePoint list item.",
              "type": "string"
            }
          },

          "additionalProperties": false
        },

        "title": {
          "title": "Title",
          "description": "Title of the application as a dictionary of locale keys to title values. This value will be displayed to the user in the (page creation) interface. A dictionary must contain a \"default\" key.",
          "$ref": "localizedString.json"
        },

        "description": {
          "title": "Description",
          "description": "Description of the application represented as a dictionary of locale keys to description values. This value will be displayed to the user in the (page creation) interface. A dictionary must contain a \"default\" key.",
          "$ref": "localizedString.json"
        },

        "preloadComponents": {
          "title": "Preload Components",
          "description": "A list of component manifests that must be preloaded alongside this application. These may include external resources or webparts that are needed during initial render.",
          "type": "array",
          "uniqueItems": true,
          "minItems": 0,
          "items": {
            "type": "string",
            "minLength": 10
          }
        }
      },

      "additionalProperties": true
    }
  ]
}
