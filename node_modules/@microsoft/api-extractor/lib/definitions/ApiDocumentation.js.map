{"version":3,"sources":["definitions/ApiDocumentation.ts"],"names":[],"mappings":"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","file":"definitions/ApiDocumentation.js","sourcesContent":["/* tslint:disable:no-bitwise */\r\n\r\nimport ApiItem, { ApiItemKind } from './ApiItem';\r\nimport ApiPackage from './ApiPackage';\r\nimport DocElementParser from '../DocElementParser';\r\nimport { IDocElement, IParam, ICodeLinkElement } from '../IDocElement';\r\nimport { IDocItem } from '../IDocItem';\r\nimport ApiDefinitionReference, { IApiDefinintionReferenceParts } from '../ApiDefinitionReference';\r\nimport Token, { TokenType } from '../Token';\r\nimport Tokenizer from '../Tokenizer';\r\nimport Extractor from '../Extractor';\r\nimport ResolvedApiItem from '../ResolvedApiItem';\r\n\r\n/**\r\n  * An \"API Tag\" is a custom JSDoc tag which indicates whether an ApiItem definition\r\n  * is considered Public API for third party developers, as well as its release\r\n  * stage (alpha, beta, etc).\r\n  * @see https://onedrive.visualstudio.com/DefaultCollection/SPPPlat/_git/sp-client\r\n  *      ?path=/common/docs/ApiPrinciplesAndProcess.md\r\n  */\r\nexport enum ApiTag {\r\n  /**\r\n   * No API Tag was specified in the JSDoc summary.\r\n   */\r\n  None = 0,\r\n  /**\r\n   * The API was documented as internal, i.e. not callable by third party developers.\r\n   */\r\n  Internal = 1,\r\n  /**\r\n   * The API was documented as \"alpha.\"  This status is not generally used.  See the\r\n   * ApiPrinciplesAndProcess.md for details.\r\n   */\r\n  Alpha = 2,\r\n  /**\r\n   * The API was documented as callable by third party developers, but at their own risk.\r\n   * Web parts that call beta APIs should only be used for experimentation, because the Web Part\r\n   * will break if Microsoft changes the API signature later.\r\n   */\r\n  Beta = 3,\r\n  /**\r\n   * The API was documented as callable by third party developers, with a guarantee that Microsoft will\r\n   * never make any breaking changes once the API is published.\r\n   */\r\n  Public = 4\r\n}\r\n\r\n/**\r\n * A dependency for ApiDocumentation constructor that abstracts away the function \r\n * of resolving an API definition reference.\r\n * \r\n * @internalremarks reportError() will be called if the apiDefinitionRef is to a non local \r\n * item and the package of that non local item can not be found. \r\n * If there is no package given and an  item can not be found we will return undefined. \r\n * Once we support local references, we can be sure that reportError will only be \r\n * called once if the item can not be found (and undefined will be retured by the reference \r\n * function).\r\n */\r\nexport interface IReferenceResolver {\r\n  resolve(\r\n    apiDefinitionRef: ApiDefinitionReference,\r\n    apiPackage: ApiPackage,\r\n    reportError: (message: string) => void): ResolvedApiItem;\r\n}\r\n\r\nexport default class ApiDocumentation {\r\n  /**\r\n   * Match JsDoc block tags and inline tags\r\n   * Example \"@a @b@c d@e @f {whatever} {@link a} { @something } \\@g\" => [\"@a\", \"@f\", \"{@link a}\", \"{ @something }\"]\r\n   */\r\n  public static readonly _jsdocTagsRegex: RegExp = /{\\s*@(\\\\{|\\\\}|[^{}])*}|(?:^|\\s)(\\@[a-z_]+)(?=\\s|$)/gi;\r\n\r\n  // For guidance about using these tags, please see this document:\r\n  // https://onedrive.visualstudio.com/DefaultCollection/SPPPlat/_git/sp-client\r\n  //    ?path=/common/docs/ApiPrinciplesAndProcess.md\r\n  private static _allowedRegularJsdocTags: string[] = [\r\n    // (alphabetical order)\r\n    '@alpha',\r\n    '@beta',\r\n    '@betadocumentation',\r\n    '@internal',\r\n    '@internalremarks',\r\n    '@param',\r\n    '@preapproved',\r\n    '@public',\r\n    '@returns',\r\n    '@see',\r\n    '@summary',\r\n    '@deprecated',\r\n    '@readonly',\r\n    '@remarks'\r\n  ];\r\n\r\n  private static _allowedInlineJsdocTags: string[] = [\r\n    // (alphabetical order)\r\n    '@inheritdoc',\r\n    '@link'\r\n  ];\r\n\r\n  /**\r\n   * The original JsDoc comment.\r\n   *\r\n   * Example: \"This is a summary. \\{\\@link a\\} \\@remarks These are remarks.\"\r\n   */\r\n  public originalJsDoc: string;\r\n\r\n  /**\r\n   * The docComment text string split into an array of ITokenItems.  The tokens are essentially either\r\n   * JSDoc tags (which start with the \"@\" character) or substrings containing the\r\n   * remaining text.  The array can be empty, but not undefined.\r\n   * Example:\r\n   * docComment       = \"Example Function\\n@returns the number of items\\n@internal  \"\r\n   * docCommentTokens = [\r\n   *  {tokenType: 'text', parameter: 'Example Function\\n'},\r\n   *  {tokenType: '\\@returns', parameter: ''}\r\n   *  {tokenType: 'text', parameter: 'the number of items\\n'}\r\n   *  {tokenType: '@internal', parameter: ''}\r\n   * ];\r\n   */\r\n  public docCommentTokens: Token[];\r\n\r\n   /**\r\n   * docCommentTokens that are parsed into Doc Elements.\r\n   */\r\n  public summary: IDocElement[];\r\n  public deprecatedMessage: IDocElement[];\r\n  public remarks: IDocElement[];\r\n  public returnsMessage: IDocElement[];\r\n  public parameters: { [name: string]: IParam; };\r\n\r\n  /**\r\n   * A list of link elements to be processed after all basic documentation has been created \r\n   * for all items in the project. We save the processing for later because we need ApiTag \r\n   * information before we can deem a link element is valid.\r\n   * Example: If API item A has a link in it's documentation to API item B, then B must not\r\n   * have ApiTag.Internal. \r\n   */\r\n  public incompleteLinks: ICodeLinkElement[];\r\n\r\n  /**\r\n   * A list of 'Tokens' that have been recognized as inheritdoc tokens that will be processed \r\n   * after the basic documentation for all API items is complete. We save the processing for after \r\n   * because we need ApiTag information before we can deem an inheritdoc token as valid.\r\n   */\r\n  public incompleteInheritdocs: Token[];\r\n\r\n  /**\r\n   * An \"API Tag\" is a custom JSDoc tag which indicates whether this definition\r\n   * is considered Public API for third party developers, as well as its release\r\n   * stage (alpha, beta, etc).\r\n   */\r\n  public apiTag: ApiTag;\r\n\r\n  /**\r\n   * True if the \"@preapproved\" tag was specified.\r\n   * Indicates that this internal API is exempt from further reviews.\r\n   */\r\n  public preapproved?: boolean;\r\n  public deprecated?: string;\r\n  public internalremarks?: string;\r\n  public paramDocs?: Map<string, string>;\r\n  public returns?: string;\r\n  public see?: string[];\r\n  public isDocBeta?: boolean;\r\n  public isDocInherited?: boolean;\r\n  public isDocInheritedDeprecated?: boolean;\r\n  public isOverride?: boolean;\r\n  public hasReadOnlyTag?: boolean;\r\n\r\n  /**\r\n   * A function type interface that abstracts away resolving \r\n   * an API definition reference to an item that has friendly \r\n   * assessible ApiItem properties. \r\n   * \r\n   * Ex: this is useful in the case of parsing inheritdoc expressions,\r\n   * in the sense that we do not know if we the inherited documentation \r\n   * is coming from an ApiItem or a IDocItem.\r\n   */\r\n  public referenceResolver: IReferenceResolver;\r\n\r\n  /**\r\n   * We need the extractor to access the package that this ApiItem\r\n   * belongs to in order to resolve references.\r\n   */\r\n  public extractor: Extractor;\r\n\r\n  public reportError: (message: string) => void;\r\n\r\n  constructor(docComment: string,\r\n    referenceResolver: IReferenceResolver,\r\n    extractor: Extractor,\r\n    errorLogger: (message: string) => void) {\r\n    this.originalJsDoc = docComment;\r\n    this.referenceResolver = referenceResolver;\r\n    this.extractor = extractor;\r\n    this.reportError = errorLogger;\r\n    this.parameters = {};\r\n    this._parseDocs();\r\n  }\r\n\r\n  /**\r\n   * Executes the implementation details involved in completing the documentation initialization.\r\n   * Currently completes link and inheritdocs.\r\n   */\r\n  public completeInitialization(): void {\r\n    // Ensure links are valid\r\n    this._completeLinks();\r\n    // Ensure inheritdocs are valid\r\n    this._completeInheritdocs();\r\n  }\r\n\r\n  protected _parseDocs(): void {\r\n    this.summary = [];\r\n    this.returnsMessage = [];\r\n    this.deprecatedMessage = [];\r\n    this.remarks = [];\r\n    this.incompleteLinks = [];\r\n    this.incompleteInheritdocs = [];\r\n    this.apiTag = ApiTag.None;\r\n    const tokenizer: Tokenizer = new Tokenizer(this.originalJsDoc, this.reportError);\r\n    this.summary = DocElementParser.parse(this, tokenizer);\r\n\r\n    let apiTagCount: number = 0;\r\n    let parsing: boolean = true;\r\n\r\n      while (parsing) {\r\n      const token: Token = tokenizer.peekToken();\r\n      if (!token) {\r\n        parsing = false; // end of stream\r\n        // Report error if @inheritdoc is deprecated but no @deprecated tag present here\r\n        if (this.isDocInheritedDeprecated && this.deprecatedMessage.length === 0) {\r\n          // if this documentation inherits docs from a deprecated API item, then\r\n          // this documentation must either have a deprecated message or it must\r\n          // not use the @inheritdoc and copy+paste the documentation\r\n          this.reportError(`A deprecation message must be included after the @deprecated tag.`);\r\n        }\r\n        break;\r\n      }\r\n\r\n      if (token.type === TokenType.Tag) {\r\n        switch (token.tag) {\r\n          case '@remarks':\r\n            tokenizer.getToken();\r\n            this._checkInheritDocStatus();\r\n            this.remarks = DocElementParser.parse(this, tokenizer);\r\n            break;\r\n          case '@returns':\r\n            tokenizer.getToken();\r\n            this._checkInheritDocStatus();\r\n            this.returnsMessage = DocElementParser.parse(this, tokenizer);\r\n            break;\r\n          case '@param':\r\n            tokenizer.getToken();\r\n            this._checkInheritDocStatus();\r\n            const param: IParam = this._parseParam(tokenizer);\r\n            if (param) {\r\n               this.parameters[param.name] = param;\r\n            }\r\n            break;\r\n          case '@deprecated':\r\n            tokenizer.getToken();\r\n            this.deprecatedMessage = DocElementParser.parse(this, tokenizer);\r\n            if (!this.deprecatedMessage || this.deprecatedMessage.length === 0) {\r\n              this.reportError(`deprecated description required after @deprecated JSDoc tag.`);\r\n            }\r\n            break;\r\n          case '@internalremarks':\r\n            // parse but discard\r\n            tokenizer.getToken();\r\n            DocElementParser.parse(this, tokenizer);\r\n            break;\r\n          case '@public':\r\n            tokenizer.getToken();\r\n            this.apiTag = ApiTag.Public;\r\n            ++apiTagCount;\r\n            break;\r\n          case '@internal':\r\n            tokenizer.getToken();\r\n            this.apiTag = ApiTag.Internal;\r\n            ++apiTagCount;\r\n            break;\r\n          case '@alpha':\r\n            tokenizer.getToken();\r\n            this.apiTag = ApiTag.Alpha;\r\n            ++apiTagCount;\r\n            break;\r\n          case '@beta':\r\n            tokenizer.getToken();\r\n            this.apiTag = ApiTag.Beta;\r\n            ++apiTagCount;\r\n            break;\r\n          case '@preapproved':\r\n            tokenizer.getToken();\r\n            this.preapproved = true;\r\n            break;\r\n          case '@readonly':\r\n            tokenizer.getToken();\r\n            this.hasReadOnlyTag = true;\r\n            break;\r\n          case '@betadocumentation':\r\n            tokenizer.getToken();\r\n            this.isDocBeta = true;\r\n            break;\r\n          default:\r\n            tokenizer.getToken();\r\n            this._reportBadJSDocTag(token);\r\n        }\r\n      } else if (token.type === TokenType.Inline) {\r\n        switch (token.tag) {\r\n          case '@inheritdoc':\r\n            DocElementParser.parse(this, tokenizer);\r\n            break;\r\n          case '@link':\r\n            DocElementParser.parse(this, tokenizer);\r\n            break;\r\n          default:\r\n            tokenizer.getToken();\r\n            this._reportBadJSDocTag(token);\r\n            break;\r\n        }\r\n      } else if (token.type === TokenType.Text)  {\r\n        tokenizer.getToken();\r\n        // Shorten \"This is too long text\" to \"This is...\"\r\n        const MAX_LENGTH: number = 40;\r\n        let problemText: string = token.text.trim();\r\n        if (problemText.length > MAX_LENGTH) {\r\n          problemText = problemText.substr(0, MAX_LENGTH - 3).trim() + '...';\r\n        }\r\n        this.reportError(`Unexpected text in JSDoc comment: \"${problemText}\"`);\r\n      } else {\r\n        tokenizer.getToken();\r\n        // This would be a program bug\r\n        this.reportError(`Unexpected token: ${token.type} ${token.tag} ${token.text}`);\r\n      }\r\n    }\r\n\r\n    if (apiTagCount > 1) {\r\n      this.reportError('More than one API Tag was specified');\r\n    }\r\n\r\n    if (this.preapproved && this.apiTag !== ApiTag.Internal) {\r\n      this.reportError('The @preapproved tag may only be applied to @internal defintions');\r\n      this.preapproved = false;\r\n    }\r\n  }\r\n\r\n  protected _parseParam(tokenizer: Tokenizer): IParam {\r\n    const paramDescriptionToken: Token = tokenizer.getToken();\r\n    if (!paramDescriptionToken) {\r\n      this.reportError('@param tag missing required description');\r\n      return;\r\n    }\r\n    const hyphenIndex: number = paramDescriptionToken ? paramDescriptionToken.text.indexOf('-') : -1;\r\n    if (hyphenIndex < 0) {\r\n      this.reportError('No hyphens found in the @param line. ' +\r\n          'There should be a hyphen between the parameter name and its description.');\r\n      return;\r\n    } else {\r\n      const name: string = paramDescriptionToken.text.slice(0, hyphenIndex).trim();\r\n      const comment: string = paramDescriptionToken.text.substr(hyphenIndex + 1).trim();\r\n\r\n      if (!comment) {\r\n        this.reportError('@param tag requires a description following the hyphen');\r\n        return;\r\n      }\r\n\r\n      const commentTextElement: IDocElement = DocElementParser.makeTextElement(comment);\r\n      // Full param description may contain additional Tokens (Ex: @link)\r\n      const remainingElements: IDocElement[] = DocElementParser.parse(this, tokenizer);\r\n      const descriptionElements: IDocElement[] = [commentTextElement].concat(remainingElements);\r\n\r\n      const paramDocElement: IParam = {\r\n        name: name,\r\n        description: descriptionElements\r\n      };\r\n      return paramDocElement;\r\n      }\r\n  }\r\n\r\n    /**\r\n   * A processing of linkDocElements that refer to an ApiDefinitionReference. This method \r\n   * ensures that the reference is to an API item that is not 'Internal'.\r\n   */\r\n  private _completeLinks(): void {\r\n    while (this.incompleteLinks.length) {\r\n      const codeLink: ICodeLinkElement = this.incompleteLinks.pop();\r\n      const parts: IApiDefinintionReferenceParts = {\r\n        scopeName: codeLink.scopeName,\r\n        packageName: codeLink.packageName,\r\n        exportName: codeLink.exportName,\r\n        memberName: codeLink.memberName\r\n      };\r\n\r\n      const apiDefinitionRef: ApiDefinitionReference = ApiDefinitionReference.createFromParts(parts);\r\n      const resolvedApiItem: ResolvedApiItem =  this.referenceResolver.resolve(\r\n        apiDefinitionRef,\r\n        this.extractor.package,\r\n        this.reportError\r\n      );\r\n\r\n      // If the apiDefinitionRef can not be found the resolcedApiItem will be\r\n      // undefined and an error will have been reported via this.reportError\r\n      if (resolvedApiItem && resolvedApiItem.apiTag === ApiTag.Internal) {\r\n        this.reportError('Unable to link to \\\"Internal\\\" API item');\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A processing of inheritdoc 'Tokens'. This processing occurs after we have created documentation \r\n   * for all API items. \r\n   */\r\n  private _completeInheritdocs(): void {\r\n    while (this.incompleteInheritdocs.length) {\r\n      const token: Token = this.incompleteInheritdocs.pop();\r\n      DocElementParser.parseInheritDoc(this, token);\r\n    }\r\n  }\r\n\r\n  private _reportBadJSDocTag(token: Token): void {\r\n    const supportsRegular: boolean = ApiDocumentation._allowedRegularJsdocTags.indexOf(token.tag) >= 0;\r\n    const supportsInline: boolean = ApiDocumentation._allowedInlineJsdocTags.indexOf(token.tag) >= 0;\r\n\r\n    if (!supportsRegular && !supportsInline) {\r\n      this.reportError(`Unknown JSDoc tag \\\"${token.tag}\\\"`);\r\n      return;\r\n    }\r\n\r\n    if (token.type === TokenType.Inline && !supportsInline) {\r\n      this.reportError(`The JSDoc tag \\\"${token.tag}\\\" must not use the non-inline syntax (no curly braces)`);\r\n      return;\r\n    }\r\n    if (token.type === TokenType.Tag && !supportsRegular) {\r\n      this.reportError(`The JSDoc tag \\\"${token.tag}\\\" must use the inline syntax (with curly braces)`);\r\n      return;\r\n    }\r\n\r\n    this.reportError(`The JSDoc tag \\\"${token.tag}\\\" is not supported in this context`);\r\n    return;\r\n  }\r\n\r\n  private _checkInheritDocStatus(): void {\r\n    if (this.isDocInherited) {\r\n      this.reportError('Cannot provide additional JSDoc tags if @inheritdoc tag is present');\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\src"}