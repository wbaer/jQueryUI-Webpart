{"version":3,"sources":["webpack:///../webpack/bootstrap 2b831b71fdef359cf763","webpack:///.././lib/index.js","webpack:///../D:/code/sp-client/common/~/@microsoft/loader-set-webpack-public-path/lib","webpack:///.././lib/httpClient/HttpClient.js","webpack:///../external \"@microsoft/sp-core-library\"","webpack:///../external \"@microsoft/decorators\"","webpack:///.././lib/httpClient/HttpClientConfiguration.js","webpack:///.././lib/httpClient/HttpClientHelper.js","webpack:///../external \"@microsoft/sp-lodash-subset\"","webpack:///.././lib/httpClient/FetchProvider.js","webpack:///.././lib/httpClient/HttpClientResponse.js","webpack:///.././lib/spHttpClient/DigestCache.js","webpack:///../external \"@ms/sp-telemetry\"","webpack:///.././lib/spHttpClient/SPHttpClient.js","webpack:///.././lib/spHttpClient/SPHttpClientConfiguration.js","webpack:///.././lib/spHttpClient/SPHttpClientCommonConfiguration.js","webpack:///.././lib/spHttpClient/ODataVersion.js","webpack:///.././lib/spHttpClient/SPHttpClientResponse.js","webpack:///.././lib/spHttpClient/SPHttpClientBatch.js","webpack:///.././lib/spHttpClient/BatchedRequest.js","webpack:///.././lib/spHttpClient/SPHttpClientHelper.js","webpack:///.././lib/spHttpClient/SPHttpClientBatchConfiguration.js","webpack:///.././lib/oauthTokenProvider/OAuthTokenProvider.js","webpack:///../D:/code/sp-client/libraries/sp-client-shared/lib/index.js","webpack:///../D:/code/sp-client/libraries/sp-client-shared/lib/tokenUtility/OAuthUtility.js","webpack:///../D:/code/sp-client/libraries/sp-client-shared/lib/tokenUtility/Constants.js","webpack:///../D:/code/sp-client/libraries/sp-client-shared/lib/tokenUtility/OAuthUtilityError.js","webpack:///.././lib/oauthTokenProvider/OAuthUtilityContext.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACzBA;AACA;AACA;;AAEA;AACA,kBAAiB,oBAAoB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,E;;;;;;ACvBA;AACA;AACA;AACA;AACA,6CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA,+CAA8C,cAAc;AAC5D;AACA;;;;;;;ACjCA,gD;;;;;;ACAA,gD;;;;;;ACAA;AACA;AACA;AACA;AACA,6CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAsD,gBAAgB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C,cAAc;AAC5D;AACA;AACA,uCAAsC;AACtC;;;;;;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,yDAAwD;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD,+CAA8C,cAAc;AAC5D;;;;;;;ACzBA,gD;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD,+CAA8C,cAAc;AAC5D;AACA;;;;;;;ACZA;AACA;AACA;AACA;AACA,6CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,qCAAqC,EAAE;AACjE;AACA;AACA,MAAK;AACL,6DAA4D,0CAA0C;AACtG,sDAAqD,mCAAmC;AACxF,0DAAyD,uCAAuC;AAChG,sDAAqD,mCAAmC;AACxF,sDAAqD,mCAAmC;AACxF;AACA,2BAA0B,iCAAiC,EAAE;AAC7D;AACA;AACA,MAAK;AACL;AACA,2BAA0B,gCAAgC,EAAE;AAC5D;AACA;AACA,MAAK;AACL;AACA,2BAA0B,mCAAmC,EAAE;AAC/D;AACA;AACA,MAAK;AACL;AACA,2BAA0B,+BAA+B,EAAE;AAC3D;AACA;AACA,MAAK;AACL;AACA,2BAA0B,uCAAuC,EAAE;AACnE;AACA;AACA,MAAK;AACL;AACA,2BAA0B,oCAAoC,EAAE;AAChE;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA,+CAA8C,cAAc;AAC5D;;;;;;;AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAkD,cAAc;AAChE,cAAa;AACb;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA,+CAA8C,cAAc;AAC5D;;;;;;;ACpEA,iD;;;;;;ACAA;AACA;AACA;AACA;AACA,6CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,mEAAkE,gBAAgB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAAyC,6BAA6B;AACtE;AACA;AACA,sEAAqE,8DAA8D;AACnI;AACA;AACA,wEAAuE,8DAA8D;AACrI;AACA;AACA,UAAS;AACT,gEAA+D,6BAA6B;AAC5F;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C,cAAc;AAC5D;AACA;;;;;;;ACpJA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA,6CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;;;;;;ACrEA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA,6CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C,cAAc;AAC5D;;;;;;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA,+CAA8C,cAAc;AAC5D;;;;;;;AC/BA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA,6CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C,cAAc;AAC5D;AACA;;;;;;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAwD;AACxD;AACA;AACA;AACA;AACA,yDAAwD;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,6DAA4D;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,4BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAuD,mDAAmD;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA,+CAA8C,cAAc;AAC5D;;;;;;;ACxKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA,EAAC;AACD,+CAA8C,cAAc;AAC5D;;;;;;;ACvCA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,+BAA+B,EAAE;AACrE;AACA,+C;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAAyE,cAAc;AACvF;AACA;AACA,0EAAyE;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAA+D;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,EAAC;AACD,+CAA8C,cAAc;AAC5D;;;;;;;AChEA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA,6CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;;;;;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA,+CAA8C,cAAc;AAC5D;;;;;;;ACtBA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gHAA+G;AAC/G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAgE;AAChE;AACA,2DAA0D;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,kDAAiD,gBAAgB;AACjE;AACA;AACA;AACA;AACA;AACA,EAAC;AACD,+CAA8C,cAAc;AAC5D;;;;;;;ACrMA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C,cAAc;AAC5D;;;;;;;ACnBA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,uD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA,EAAC;AACD,+CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,EAAC,8FAA8F;;;;;;;ACjF/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA,+CAA8C,cAAc;AAC5D","file":"sp-http.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2b831b71fdef359cf763","\"use strict\";\nrequire('set-webpack-public-path!');\nvar HttpClient_1 = require(\"./httpClient/HttpClient\");\nexports.HttpClient = HttpClient_1.default;\nvar HttpClientConfiguration_1 = require(\"./httpClient/HttpClientConfiguration\");\nexports.HttpClientConfiguration = HttpClientConfiguration_1.default;\nvar HttpClientResponse_1 = require(\"./httpClient/HttpClientResponse\");\nexports.HttpClientResponse = HttpClientResponse_1.default;\nvar DigestCache_1 = require(\"./spHttpClient/DigestCache\");\nexports.DigestCache = DigestCache_1.default;\nvar SPHttpClient_1 = require(\"./spHttpClient/SPHttpClient\");\nexports.SPHttpClient = SPHttpClient_1.default;\nvar SPHttpClientCommonConfiguration_1 = require(\"./spHttpClient/SPHttpClientCommonConfiguration\");\nexports.SPHttpClientCommonConfiguration = SPHttpClientCommonConfiguration_1.default;\nvar SPHttpClientConfiguration_1 = require(\"./spHttpClient/SPHttpClientConfiguration\");\nexports.SPHttpClientConfiguration = SPHttpClientConfiguration_1.default;\nvar SPHttpClientResponse_1 = require(\"./spHttpClient/SPHttpClientResponse\");\nexports.SPHttpClientResponse = SPHttpClientResponse_1.default;\nvar SPHttpClientBatchConfiguration_1 = require(\"./spHttpClient/SPHttpClientBatchConfiguration\");\nexports.SPHttpClientBatchConfiguration = SPHttpClientBatchConfiguration_1.default;\nvar SPHttpClientBatch_1 = require(\"./spHttpClient/SPHttpClientBatch\");\nexports.SPHttpClientBatch = SPHttpClientBatch_1.default;\nvar ODataVersion_1 = require(\"./spHttpClient/ODataVersion\");\nexports.ODataVersion = ODataVersion_1.default;\nvar OAuthTokenProvider_1 = require(\"./oauthTokenProvider/OAuthTokenProvider\");\nexports.OAuthTokenProvider = OAuthTokenProvider_1.default;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/index.js\n// module id = 0\n// module chunks = 0","var scripts = document.getElementsByTagName('script');\r\nvar regex = new RegExp('ScriptLoadName-DoNotChange', 'i');\r\nvar found = false;\r\n\r\nif (scripts && scripts.length) {\r\n  for (var i = 0; i < scripts.length; i++) {\r\n    if (!scripts[i]) continue;\r\n    var path = scripts[i].getAttribute('src');\r\n    if (path && path.match(regex)) {\r\n      __webpack_public_path__ = path.substring(0, path.lastIndexOf('/') + 1);\r\n      found = true;\r\n      break;\r\n    }\r\n  }\r\n}\r\n\r\nif (!found) {\r\n  for (var global in window.__setWebpackPublicPathLoaderSrcRegistry__) {\r\n    if (global && global.match(regex)) {\r\n      __webpack_public_path__ = global.substring(0, global.lastIndexOf('/') + 1);\r\n      break;\r\n    }\r\n  }\r\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/code/sp-client/common/~/@microsoft/loader-set-webpack-public-path/lib\n// module id = 1\n// module chunks = 0","\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar sp_core_library_1 = require(\"@microsoft/sp-core-library\");\nvar decorators_1 = require(\"@microsoft/decorators\");\nvar HttpClientConfiguration_1 = require(\"./HttpClientConfiguration\");\nvar HttpClientHelper_1 = require(\"./HttpClientHelper\");\nvar HttpClient = HttpClient_1 = (function () {\n    function HttpClient(serviceScope) {\n        this._httpClientBase = new HttpClientHelper_1.default(serviceScope, 'HttpClient');\n    }\n    HttpClient.prototype.fetch = function (url, configuration, options) {\n        return this._httpClientBase.fetchCore(configuration, new Request(url, options));\n    };\n    HttpClient.prototype.get = function (url, configuration, options) {\n        return this.fetch(url, configuration, this._httpClientBase.overrideHttpMethod(options, 'GET'));\n    };\n    HttpClient.prototype.post = function (url, configuration, options) {\n        return this.fetch(url, configuration, this._httpClientBase.overrideHttpMethod(options, 'POST'));\n    };\n    return HttpClient;\n}());\nHttpClient.configurations = HttpClientConfiguration_1.predefinedConfigurations;\nHttpClient.serviceKey = sp_core_library_1.ServiceKey.create('sp-http:HttpClient', HttpClient_1);\nHttpClient = HttpClient_1 = __decorate([\n    decorators_1.sealed\n], HttpClient);\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = HttpClient;\nvar HttpClient_1;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/httpClient/HttpClient.js\n// module id = 2\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/sp-core-library\"\n// module id = 3\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/decorators\"\n// module id = 4\n// module chunks = 0","\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar decorators_1 = require(\"@microsoft/decorators\");\nvar HttpClientConfiguration = (function () {\n    function HttpClientConfiguration(flags, overrideFlags) {\n        this.flags = {};\n        this.initializeFlags();\n        this._mergeFlags(flags);\n        if (overrideFlags) {\n            this._mergeFlags(overrideFlags);\n        }\n    }\n    HttpClientConfiguration.prototype.overrideWith = function (sourceFlags) {\n        return new HttpClientConfiguration(this.flags, sourceFlags);\n    };\n    HttpClientConfiguration.prototype.initializeFlags = function () {\n    };\n    HttpClientConfiguration.prototype._mergeFlags = function (source) {\n        for (var _i = 0, _a = Object.keys(this.flags); _i < _a.length; _i++) {\n            var key = _a[_i];\n            if (source.hasOwnProperty(key)) {\n                if (source[key] !== undefined) {\n                    this.flags[key] = source[key];\n                }\n            }\n        }\n    };\n    return HttpClientConfiguration;\n}());\n__decorate([\n    decorators_1.virtual\n], HttpClientConfiguration.prototype, \"overrideWith\", null);\n__decorate([\n    decorators_1.virtual\n], HttpClientConfiguration.prototype, \"initializeFlags\", null);\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = HttpClientConfiguration;\nexports.predefinedConfigurations = {\n    v1: new HttpClientConfiguration({})\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/httpClient/HttpClientConfiguration.js\n// module id = 5\n// module chunks = 0","\"use strict\";\nvar sp_core_library_1 = require(\"@microsoft/sp-core-library\");\nvar lodash = require(\"@microsoft/sp-lodash-subset\");\nvar FetchProvider_1 = require(\"./FetchProvider\");\nvar HttpClientHelper = (function () {\n    function HttpClientHelper(serviceScope, logSource) {\n        var _this = this;\n        this._serviceScope = serviceScope;\n        this._logSource = logSource;\n        serviceScope.whenFinished(function () {\n            _this._fetchProvider = serviceScope.consume(FetchProvider_1.fetchProviderServiceKey);\n        });\n    }\n    HttpClientHelper.prototype.overrideHttpMethod = function (options, httpRequestMethod) {\n        var modifiedOptions = lodash.clone(options || {});\n        modifiedOptions.method = httpRequestMethod;\n        return modifiedOptions;\n    };\n    HttpClientHelper.prototype.fetchCore = function (configuration, request) {\n        sp_core_library_1.Log.info(this._logSource, request.method + \" \" + request.url, this._serviceScope);\n        return this._fetchProvider.fetch(request);\n    };\n    return HttpClientHelper;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = HttpClientHelper;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/httpClient/HttpClientHelper.js\n// module id = 6\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_7__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/sp-lodash-subset\"\n// module id = 7\n// module chunks = 0","\"use strict\";\nvar sp_core_library_1 = require(\"@microsoft/sp-core-library\");\nvar FetchProvider = (function () {\n    function FetchProvider(serviceScope) {\n    }\n    FetchProvider.prototype.fetch = function (request) {\n        return window.fetch(request);\n    };\n    return FetchProvider;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = FetchProvider;\nexports.fetchProviderServiceKey = sp_core_library_1.ServiceKey.create('sp-client-base:FetchProvider', FetchProvider);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/httpClient/FetchProvider.js\n// module id = 8\n// module chunks = 0","\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar decorators_1 = require(\"@microsoft/decorators\");\nvar HttpClientResponse = (function () {\n    function HttpClientResponse(response) {\n        this.nativeResponse = response;\n    }\n    Object.defineProperty(HttpClientResponse.prototype, \"bodyUsed\", {\n        get: function () { return this.nativeResponse.bodyUsed; },\n        enumerable: true,\n        configurable: true\n    });\n    HttpClientResponse.prototype.arrayBuffer = function () { return this.nativeResponse.arrayBuffer(); };\n    HttpClientResponse.prototype.blob = function () { return this.nativeResponse.blob(); };\n    HttpClientResponse.prototype.formData = function () { return this.nativeResponse.formData(); };\n    HttpClientResponse.prototype.json = function () { return this.nativeResponse.json(); };\n    HttpClientResponse.prototype.text = function () { return this.nativeResponse.text(); };\n    Object.defineProperty(HttpClientResponse.prototype, \"type\", {\n        get: function () { return this.nativeResponse.type; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HttpClientResponse.prototype, \"url\", {\n        get: function () { return this.nativeResponse.url; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HttpClientResponse.prototype, \"status\", {\n        get: function () { return this.nativeResponse.status; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HttpClientResponse.prototype, \"ok\", {\n        get: function () { return this.nativeResponse.ok; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HttpClientResponse.prototype, \"statusText\", {\n        get: function () { return this.nativeResponse.statusText; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HttpClientResponse.prototype, \"headers\", {\n        get: function () { return this.nativeResponse.headers; },\n        enumerable: true,\n        configurable: true\n    });\n    HttpClientResponse.prototype.clone = function () {\n        return new HttpClientResponse(this.nativeResponse.clone());\n    };\n    return HttpClientResponse;\n}());\n__decorate([\n    decorators_1.virtual\n], HttpClientResponse.prototype, \"clone\", null);\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = HttpClientResponse;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/httpClient/HttpClientResponse.js\n// module id = 9\n// module chunks = 0","\"use strict\";\nvar sp_telemetry_1 = require(\"@ms/sp-telemetry\");\nvar sp_core_library_1 = require(\"@microsoft/sp-core-library\");\nvar FetchProvider_1 = require(\"../httpClient/FetchProvider\");\nvar DigestCache = (function () {\n    function DigestCache(serviceScope) {\n        var _this = this;\n        this._digestsByUrl = new Map();\n        serviceScope.whenFinished(function () {\n            _this._fetchProvider = serviceScope.consume(FetchProvider_1.fetchProviderServiceKey);\n            _this._timeProvider = serviceScope.consume(sp_core_library_1.TimeProvider.serviceKey);\n        });\n    }\n    DigestCache.prototype.fetchDigest = function (webUrl) {\n        var _this = this;\n        var normalizedWebUrl = sp_core_library_1.UrlUtilities.removeEndSlash(webUrl);\n        var cachedDigest = this._digestsByUrl.get(normalizedWebUrl);\n        if (cachedDigest) {\n            var timestamp = this._timeProvider.getTimestamp();\n            if (timestamp < cachedDigest.expirationTimestamp) {\n                sp_telemetry_1._TraceLogger.logVerbose(DigestCache._logSource, 'DigestCache: Reusing cached digest.  Expiration: ' + cachedDigest.expirationTimestamp);\n                return Promise.resolve(cachedDigest.value);\n            }\n        }\n        var digestUrl = normalizedWebUrl + '/_api/contextinfo';\n        var rawRequest = new Request(digestUrl, {\n            method: 'POST',\n            headers: {\n                'Accept': 'application/json',\n                'Content-type': 'application/json;odata=verbose;charset=utf-8'\n            },\n            credentials: 'same-origin',\n            cache: 'no-cache'\n        });\n        return this._fetchProvider.fetch(rawRequest).then(function (response) {\n            return response.json();\n        }).then(function (responseObject) {\n            var digestValue = responseObject.FormDigestValue;\n            var seconds = responseObject.FormDigestTimeoutSeconds;\n            var expirationTimeMs = _this._timeProvider.getTimestamp() + 1000 * seconds;\n            _this.addDigestToCache(normalizedWebUrl, digestValue, expirationTimeMs);\n            sp_telemetry_1._TraceLogger.logVerbose(DigestCache._logSource, 'DigestCache: Fetched new digest');\n            return digestValue;\n        });\n    };\n    DigestCache.prototype.addDigestToCache = function (webUrl, digestValue, expirationTimestamp) {\n        var normalizedWebUrl = sp_core_library_1.UrlUtilities.removeEndSlash(webUrl);\n        var newCachedDigest = {\n            value: digestValue,\n            expirationTimestamp: expirationTimestamp - DigestCache.EXPIRATION_SLOP_MS\n        };\n        this._digestsByUrl.set(normalizedWebUrl, newCachedDigest);\n    };\n    DigestCache.prototype.clearDigest = function (webUrl) {\n        var normalizedWebUrl = sp_core_library_1.UrlUtilities.removeEndSlash(webUrl);\n        var found = this._digestsByUrl.delete(normalizedWebUrl);\n        sp_telemetry_1._TraceLogger.logVerbose(DigestCache._logSource, \"DigestCache: Requested to clear cache entry: \" + (found ? 'found' : 'not found'));\n        return found;\n    };\n    DigestCache.prototype.clearAllDigests = function () {\n        this._digestsByUrl.clear();\n    };\n    return DigestCache;\n}());\nDigestCache.serviceKey = sp_core_library_1.ServiceKey.create('sp-client-base:DigestCache', DigestCache);\nDigestCache.EXPIRATION_SLOP_MS = 3000;\nDigestCache._logSource = sp_telemetry_1._LogSource.create('DigestCache');\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = DigestCache;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/spHttpClient/DigestCache.js\n// module id = 10\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_11__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@ms/sp-telemetry\"\n// module id = 11\n// module chunks = 0","\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar decorators_1 = require(\"@microsoft/decorators\");\nvar lodash = require(\"@microsoft/sp-lodash-subset\");\nvar sp_telemetry_1 = require(\"@ms/sp-telemetry\");\nvar sp_core_library_1 = require(\"@microsoft/sp-core-library\");\nvar DigestCache_1 = require(\"./DigestCache\");\nvar SPHttpClientConfiguration_1 = require(\"./SPHttpClientConfiguration\");\nvar SPHttpClientResponse_1 = require(\"./SPHttpClientResponse\");\nvar SPHttpClientBatch_1 = require(\"./SPHttpClientBatch\");\nvar SPHttpClientHelper_1 = require(\"./SPHttpClientHelper\");\nvar ODataVersion_1 = require(\"./ODataVersion\");\nvar SPHttpClient = SPHttpClient_1 = (function () {\n    function SPHttpClient(serviceScope) {\n        var _this = this;\n        this._spHttpClientHelper = new SPHttpClientHelper_1.default(serviceScope, 'SPHttpClient');\n        this._serviceScope = serviceScope;\n        this._serviceScope.whenFinished(function () {\n            _this._digestCache = serviceScope.consume(DigestCache_1.default.serviceKey);\n            _this._randomNumberGenerator = serviceScope.consume(sp_core_library_1.RandomNumberGenerator.serviceKey);\n            _this._parentSource = serviceScope.consume(sp_telemetry_1._logSourceServiceKey);\n        });\n    }\n    SPHttpClient.getWebUrlFromRequestUrl = function (requestUrl) {\n        var segmentIndex = -1;\n        var upperCaseUrl = requestUrl.toUpperCase();\n        for (var _i = 0, _a = SPHttpClient_1._reservedUrlSegments; _i < _a.length; _i++) {\n            var reservedUrlSegment = _a[_i];\n            segmentIndex = upperCaseUrl.indexOf(reservedUrlSegment);\n            if (segmentIndex >= 0) {\n                return requestUrl.substr(0, segmentIndex);\n            }\n        }\n        throw new Error('Unable to determine web URL');\n    };\n    SPHttpClient.prototype.fetch = function (url, configuration, options) {\n        var _this = this;\n        if (!options) {\n            options = {};\n        }\n        var modifiedOptions = lodash.clone(options);\n        if (configuration.defaultSameOriginCredentials) {\n            if (!options.credentials) {\n                modifiedOptions.credentials = 'same-origin';\n            }\n        }\n        var headers = SPHttpClientHelper_1.default.cloneHeaders(options);\n        modifiedOptions.headers = headers;\n        if (configuration.defaultODataVersion) {\n            if (!headers.has('OData-Version')) {\n                headers.append('OData-Version', configuration.defaultODataVersion.toString());\n            }\n        }\n        var oDataVersion = ODataVersion_1.default.tryParseFromHeaders(headers);\n        SPHttpClientHelper_1.default.applyDefaultHeaders(headers, configuration, options, oDataVersion);\n        if (configuration.requestDigest) {\n            if (options.method) {\n                var method = options.method.toUpperCase();\n                if (method !== 'GET' && method !== 'HEAD' && method !== 'OPTIONS') {\n                    if (!headers.has('X-RequestDigest')) {\n                        var webUrl = options.webUrl || SPHttpClient_1.getWebUrlFromRequestUrl(url);\n                        var promise = this._digestCache.fetchDigest(webUrl)\n                            .then(function (digest) {\n                            headers.append('X-RequestDigest', digest);\n                            return _this._fetchWithInstrumentation(configuration, new Request(url, modifiedOptions));\n                        });\n                        return SPHttpClientHelper_1.default.handleAuthenticationErrors(promise, webUrl, this._digestCache)\n                            .then(function (response) {\n                            return new SPHttpClientResponse_1.default(response);\n                        });\n                    }\n                }\n            }\n        }\n        return this._fetchWithInstrumentation(configuration, new Request(url, modifiedOptions))\n            .then(function (response) {\n            return new SPHttpClientResponse_1.default(response);\n        });\n    };\n    SPHttpClient.prototype.get = function (url, configuration, options) {\n        return this.fetch(url, configuration, this._spHttpClientHelper.overrideHttpMethod(options, 'GET'));\n    };\n    SPHttpClient.prototype.post = function (url, configuration, options) {\n        return this.fetch(url, configuration, this._spHttpClientHelper.overrideHttpMethod(options, 'POST'));\n    };\n    SPHttpClient.prototype.beginBatch = function (batchCreationOptions) {\n        return new SPHttpClientBatch_1.default(this._serviceScope, batchCreationOptions);\n    };\n    SPHttpClient.prototype._fetchWithInstrumentation = function (configuration, request) {\n        var _this = this;\n        var tag = this._performanceTag;\n        sp_telemetry_1._PerformanceLogger.startMarkForApi(tag);\n        var qosMonitor = new sp_telemetry_1._QosMonitor('SPHttpClient');\n        return this._spHttpClientHelper.fetchCore(configuration, request).then(function (response) {\n            sp_telemetry_1._PerformanceLogger.endMarkForApi(tag, _this._logSourceId, request.url, response);\n            if (response.status >= 200 && response.status <= 299) {\n                qosMonitor.writeSuccess({ source: _this._logSourceId });\n            }\n            else if (response.status >= 300 && response.status <= 499) {\n                qosMonitor.writeExpectedFailure('Fetch', undefined, { source: _this._logSourceId, responseStatus: response.status });\n            }\n            else {\n                qosMonitor.writeUnexpectedFailure('Fetch', undefined, { source: _this._logSourceId, responseStatus: response.status });\n            }\n            return response;\n        }).catch(function (error) {\n            qosMonitor.writeUnexpectedFailure('Fetch', error, { source: _this._logSourceId });\n            throw error;\n        });\n    };\n    Object.defineProperty(SPHttpClient.prototype, \"_performanceTag\", {\n        get: function () {\n            var randomSuffix = Math.floor(this._randomNumberGenerator.generate() * 100000).toString();\n            return this._logSourceId + \".\" + randomSuffix;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPHttpClient.prototype, \"_logSourceId\", {\n        get: function () {\n            if (this._parentSource.isEmpty()) {\n                return SPHttpClient_1._logSource.id;\n            }\n            return this._parentSource.id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SPHttpClient;\n}());\nSPHttpClient.configurations = SPHttpClientConfiguration_1.predefinedConfigurations;\nSPHttpClient.serviceKey = sp_core_library_1.ServiceKey.create('sp-http:SPHttpClient', SPHttpClient_1);\nSPHttpClient._logSource = sp_telemetry_1._LogSource.create('spHttpClient');\nSPHttpClient._reservedUrlSegments = [\n    '/_API/',\n    '/_LAYOUTS/',\n    '/_VTI_BIN/'\n];\nSPHttpClient = SPHttpClient_1 = __decorate([\n    decorators_1.sealed\n], SPHttpClient);\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPHttpClient;\nvar SPHttpClient_1;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/spHttpClient/SPHttpClient.js\n// module id = 12\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar decorators_1 = require(\"@microsoft/decorators\");\nvar SPHttpClientCommonConfiguration_1 = require(\"./SPHttpClientCommonConfiguration\");\nvar ODataVersion_1 = require(\"./ODataVersion\");\nvar HttpClient_1 = require(\"../httpClient/HttpClient\");\nvar SPHttpClientConfiguration = (function (_super) {\n    __extends(SPHttpClientConfiguration, _super);\n    function SPHttpClientConfiguration(flags, overrideFlags) {\n        return _super.call(this, flags, overrideFlags) || this;\n    }\n    SPHttpClientConfiguration.prototype.overrideWith = function (sourceFlags) {\n        return new SPHttpClientConfiguration(this.flags, sourceFlags);\n    };\n    Object.defineProperty(SPHttpClientConfiguration.prototype, \"defaultSameOriginCredentials\", {\n        get: function () {\n            return this.flags.defaultSameOriginCredentials;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPHttpClientConfiguration.prototype, \"defaultODataVersion\", {\n        get: function () {\n            return this.flags.defaultODataVersion;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPHttpClientConfiguration.prototype, \"requestDigest\", {\n        get: function () {\n            return this.flags.requestDigest;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SPHttpClientConfiguration.prototype.initializeFlags = function () {\n        _super.prototype.initializeFlags.call(this);\n        this.flags.defaultSameOriginCredentials = false;\n        this.flags.defaultODataVersion = ODataVersion_1.default.v3;\n        this.flags.requestDigest = false;\n    };\n    return SPHttpClientConfiguration;\n}(SPHttpClientCommonConfiguration_1.default));\n__decorate([\n    decorators_1.override\n], SPHttpClientConfiguration.prototype, \"overrideWith\", null);\n__decorate([\n    decorators_1.override\n], SPHttpClientConfiguration.prototype, \"initializeFlags\", null);\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPHttpClientConfiguration;\nexports.predefinedConfigurations = {\n    v1: new SPHttpClientConfiguration(HttpClient_1.default.configurations.v1, {\n        jsonRequest: true,\n        jsonResponse: true,\n        defaultSameOriginCredentials: true,\n        defaultODataVersion: ODataVersion_1.default.v4,\n        requestDigest: true\n    })\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/spHttpClient/SPHttpClientConfiguration.js\n// module id = 13\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar decorators_1 = require(\"@microsoft/decorators\");\nvar HttpClientConfiguration_1 = require(\"../httpClient/HttpClientConfiguration\");\nvar SPHttpClientCommonConfiguration = (function (_super) {\n    __extends(SPHttpClientCommonConfiguration, _super);\n    function SPHttpClientCommonConfiguration(flags, overrideFlags) {\n        return _super.call(this, flags, overrideFlags) || this;\n    }\n    SPHttpClientCommonConfiguration.prototype.initializeFlags = function () {\n        _super.prototype.initializeFlags.call(this);\n        this.flags.jsonRequest = false;\n        this.flags.jsonResponse = false;\n    };\n    SPHttpClientCommonConfiguration.prototype.overrideWith = function (sourceFlags) {\n        return new SPHttpClientCommonConfiguration(this.flags, sourceFlags);\n    };\n    Object.defineProperty(SPHttpClientCommonConfiguration.prototype, \"jsonRequest\", {\n        get: function () {\n            return this.flags.jsonRequest;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPHttpClientCommonConfiguration.prototype, \"jsonResponse\", {\n        get: function () {\n            return this.flags.jsonResponse;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SPHttpClientCommonConfiguration;\n}(HttpClientConfiguration_1.default));\n__decorate([\n    decorators_1.override\n], SPHttpClientCommonConfiguration.prototype, \"initializeFlags\", null);\n__decorate([\n    decorators_1.override\n], SPHttpClientCommonConfiguration.prototype, \"overrideWith\", null);\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPHttpClientCommonConfiguration;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/spHttpClient/SPHttpClientCommonConfiguration.js\n// module id = 14\n// module chunks = 0","\"use strict\";\nvar ODataVersion = (function () {\n    function ODataVersion(versionString) {\n        this._versionString = versionString;\n    }\n    ODataVersion.tryParseFromHeaders = function (headers) {\n        var oDataVersion;\n        headers.forEach(function (value, name) {\n            if (name.toUpperCase() === 'ODATA-VERSION') {\n                oDataVersion = value.trim();\n            }\n        });\n        if (oDataVersion === '3.0') {\n            return ODataVersion.v3;\n        }\n        else if (oDataVersion === '4.0') {\n            return ODataVersion.v4;\n        }\n        else if (oDataVersion) {\n            throw new Error('Unsupported OData-Version header: ' + oDataVersion);\n        }\n        return undefined;\n    };\n    ODataVersion.prototype.toString = function () {\n        return this._versionString;\n    };\n    return ODataVersion;\n}());\nODataVersion.v3 = new ODataVersion('3.0');\nODataVersion.v4 = new ODataVersion('4.0');\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ODataVersion;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/spHttpClient/ODataVersion.js\n// module id = 15\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar decorators_1 = require(\"@microsoft/decorators\");\nvar HttpClientResponse_1 = require(\"../httpClient/HttpClientResponse\");\nvar SPHttpClientResponse = SPHttpClientResponse_1 = (function (_super) {\n    __extends(SPHttpClientResponse, _super);\n    function SPHttpClientResponse(response) {\n        return _super.call(this, response) || this;\n    }\n    SPHttpClientResponse.prototype.clone = function () {\n        return new SPHttpClientResponse_1(this.nativeResponse.clone());\n    };\n    return SPHttpClientResponse;\n}(HttpClientResponse_1.default));\n__decorate([\n    decorators_1.override\n], SPHttpClientResponse.prototype, \"clone\", null);\nSPHttpClientResponse = SPHttpClientResponse_1 = __decorate([\n    decorators_1.sealed\n], SPHttpClientResponse);\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPHttpClientResponse;\nvar SPHttpClientResponse_1;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/spHttpClient/SPHttpClientResponse.js\n// module id = 16\n// module chunks = 0","\"use strict\";\nvar lodash = require(\"@microsoft/sp-lodash-subset\");\nvar sp_core_library_1 = require(\"@microsoft/sp-core-library\");\nvar BatchedRequest_1 = require(\"./BatchedRequest\");\nvar SPHttpClient_1 = require(\"./SPHttpClient\");\nvar SPHttpClientResponse_1 = require(\"./SPHttpClientResponse\");\nvar FetchProvider_1 = require(\"../httpClient/FetchProvider\");\nvar DigestCache_1 = require(\"./DigestCache\");\nvar SPHttpClientHelper_1 = require(\"./SPHttpClientHelper\");\nvar ODataVersion_1 = require(\"./ODataVersion\");\nvar SPHttpClientBatchConfiguration_1 = require(\"./SPHttpClientBatchConfiguration\");\nvar SPHttpClientBatch = (function () {\n    function SPHttpClientBatch(serviceScope, batchCreationOptions) {\n        var _this = this;\n        this._batchCreationOptions = batchCreationOptions || {};\n        this._batchedRequests = [];\n        serviceScope.whenFinished(function () {\n            _this._fetchProvider = serviceScope.consume(FetchProvider_1.fetchProviderServiceKey);\n            _this._randomNumberGenerator = serviceScope.consume(sp_core_library_1.RandomNumberGenerator.serviceKey);\n            _this._digestCache = serviceScope.consume(DigestCache_1.default.serviceKey);\n        });\n    }\n    SPHttpClientBatch.prototype.fetch = function (url, configuration, options) {\n        if (!options) {\n            options = {};\n        }\n        var modifiedOptions = lodash.clone(options);\n        modifiedOptions.headers = SPHttpClientHelper_1.default.cloneHeaders(options);\n        SPHttpClientHelper_1.default.applyDefaultHeaders(modifiedOptions.headers, configuration, options, ODataVersion_1.default.v4);\n        var request = new Request(url, modifiedOptions);\n        var requestUrl = request.url;\n        if (!this._webUrl) {\n            this._webUrl = SPHttpClient_1.default.getWebUrlFromRequestUrl(requestUrl);\n        }\n        var batchedRequest = new BatchedRequest_1.default(request);\n        this._batchedRequests.push(batchedRequest);\n        return batchedRequest.promise;\n    };\n    SPHttpClientBatch.prototype.get = function (url, configuration, options) {\n        var modifiedOptions = lodash.clone(options || {});\n        modifiedOptions.method = 'GET';\n        return this.fetch(url, configuration, modifiedOptions);\n    };\n    SPHttpClientBatch.prototype.post = function (url, configuration, options) {\n        var modifiedOptions = lodash.clone(options || {});\n        modifiedOptions.method = 'POST';\n        return this.fetch(url, configuration, modifiedOptions);\n    };\n    SPHttpClientBatch.prototype.execute = function () {\n        var _this = this;\n        var batchBody = '\\n';\n        var batchGuid = sp_core_library_1.Guid.newGuid(this._randomNumberGenerator);\n        var chain = Promise.resolve();\n        this._batchedRequests.forEach(function (batchedRequest) {\n            chain = chain.then(function () {\n                return batchedRequest.request.text();\n            }).then(function (requestText) {\n                var request = batchedRequest.request;\n                batchBody += \"--batch_\" + batchGuid.toString() + \"\\n\";\n                batchBody += \"Content-type: application/http\\n\"\n                    + \"Content-Transfer-Encoding: binary\\n\\n\";\n                batchBody += request.method + \" \" + request.url + \" HTTP/1.1\\n\";\n                request.headers.forEach(function (value, name) {\n                    batchBody += name + \": \" + value + \"\\n\";\n                });\n                batchBody += '\\n';\n                batchBody += requestText;\n                batchBody += '\\n\\n';\n            });\n        });\n        return chain.then(function () {\n            batchBody += \"--batch_\" + batchGuid + \"--\\n\";\n            return _this._digestCache.fetchDigest(_this._webUrl);\n        }).then(function (digest) {\n            var headers = new Headers();\n            headers.append('Accept', 'application/json');\n            headers.append('OData-Version', '4.0');\n            headers.append('Content-Type', \"multipart/mixed; boundary=batch_\" + batchGuid);\n            headers.append('Content-Length', batchBody.length.toString());\n            headers.append('X-RequestDigest', digest);\n            var request = new Request(_this._webUrl + '/_api/$batch', {\n                method: 'POST',\n                headers: headers,\n                body: batchBody,\n                credentials: 'same-origin',\n                cache: 'no-cache'\n            });\n            var promise = _this._fetchProvider.fetch(request);\n            return SPHttpClientHelper_1.default.handleAuthenticationErrors(promise, _this._webUrl, _this._digestCache);\n        }).then(function (response) {\n            if (!response.ok) {\n                throw new Error('SPHttpClientBatch: The batch request failed: ' + response.statusText);\n            }\n            return response.text();\n        }).then(function (text) {\n            var responses = _this._parseResponsesFromBody(text);\n            if (responses.length !== _this._batchedRequests.length) {\n                throw new Error(\"SPHttpClientBatch: Expecting \" + _this._batchedRequests.length + \" responses\");\n            }\n            for (var i = 0; i < _this._batchedRequests.length; ++i) {\n                var request = _this._batchedRequests[i];\n                request.notifyCompleted(new SPHttpClientResponse_1.default(responses[i]));\n            }\n            return _this;\n        });\n    };\n    SPHttpClientBatch.prototype._parseResponsesFromBody = function (text) {\n        var responses = [];\n        var header = '--batchresponse_';\n        var statusRegExp = new RegExp('^HTTP/[0-9.]+ +([0-9]+) +(.*)', 'i');\n        var lines = text.split('\\n');\n        var parserState = 'batch';\n        var batchStatus;\n        var batchStatusText;\n        for (var i = 0; i < lines.length; ++i) {\n            var line = lines[i];\n            switch (parserState) {\n                case 'batch':\n                    if (line.substr(0, header.length) === header) {\n                        parserState = 'batchHeaders';\n                    }\n                    else {\n                        if (line.trim() !== '') {\n                            throw new Error('SPHttpClientBatch: Invalid response, line ' + i);\n                        }\n                    }\n                    break;\n                case 'batchHeaders':\n                    if (line.trim() === '') {\n                        parserState = 'status';\n                    }\n                    break;\n                case 'status':\n                    var parts = statusRegExp.exec(line);\n                    if (!parts || parts && parts.length !== 3) {\n                        throw new Error('SPHttpClientBatch: Invalid status, line ' + i);\n                    }\n                    batchStatus = parseInt(parts[1], 10);\n                    batchStatusText = parts[2];\n                    parserState = 'statusHeaders';\n                    break;\n                case 'statusHeaders':\n                    if (line.trim() === '') {\n                        parserState = 'body';\n                    }\n                    break;\n                case 'body':\n                    var response = void 0;\n                    if (batchStatus === 204) {\n                        response = new Response();\n                    }\n                    else {\n                        response = new Response(line, { status: batchStatus, statusText: batchStatusText });\n                    }\n                    responses.push(response);\n                    parserState = 'batch';\n                    break;\n            }\n        }\n        if (parserState !== 'status') {\n            throw new Error('SPHttpClientBatch: Unexpected end of input');\n        }\n        return responses;\n    };\n    return SPHttpClientBatch;\n}());\nSPHttpClientBatch.configurations = SPHttpClientBatchConfiguration_1.predefinedConfigurations;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPHttpClientBatch;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/spHttpClient/SPHttpClientBatch.js\n// module id = 17\n// module chunks = 0","\"use strict\";\nvar BatchedRequest = (function () {\n    function BatchedRequest(request) {\n        var _this = this;\n        this.request = request;\n        this.response = undefined;\n        this._queuedPromiseResolves = [];\n        this._queuedPromiseRejects = [];\n        this.promise = new Promise(\n        function (resolve, reject) {\n            if (_this.response !== undefined) {\n                resolve(_this.response);\n            }\n            else {\n                _this._queuedPromiseResolves.push(resolve);\n                _this._queuedPromiseRejects.push(reject);\n            }\n        });\n    }\n    BatchedRequest.prototype.notifyCompleted = function (response) {\n        var _this = this;\n        this.response = response;\n        if (response.ok) {\n            this._queuedPromiseResolves.forEach(function (callback) {\n                callback(_this.response);\n            });\n        }\n        else {\n            var error_1 = new Error('SPHttpClientBatch: Batched request failed');\n            this._queuedPromiseRejects.forEach(function (callback) {\n                callback(error_1);\n            });\n        }\n        this._queuedPromiseResolves = [];\n        this._queuedPromiseRejects = [];\n    };\n    return BatchedRequest;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = BatchedRequest;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/spHttpClient/BatchedRequest.js\n// module id = 18\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar ODataVersion_1 = require(\"./ODataVersion\");\nvar HttpClientHelper_1 = require(\"../httpClient/HttpClientHelper\");\nvar SPHttpClientHelper = (function (_super) {\n    __extends(SPHttpClientHelper, _super);\n    function SPHttpClientHelper() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SPHttpClientHelper.cloneHeaders = function (options) {\n        var clonedHeaders = new Headers();\n        var temp = new Request('', { headers: options.headers || {} });\n        temp.headers.forEach(function (value, name) {\n            clonedHeaders.append(name, value); \n        });\n        return clonedHeaders;\n    };\n    SPHttpClientHelper.applyDefaultHeaders = function (headers, configuration, options, oDataVersion) {\n        if (configuration.jsonRequest) {\n            if (options.method && options.method.toUpperCase() !== 'GET') {\n                if (!headers.has('Content-Type')) {\n                    if (oDataVersion === ODataVersion_1.default.v3) {\n                        headers.append('Content-Type', 'application/json;odata=verbose;charset=utf-8');\n                    }\n                    else if (oDataVersion === ODataVersion_1.default.v4) {\n                        headers.append('Content-Type', 'application/json;charset=utf-8');\n                    }\n                    else {\n                        throw new Error('ISPHttpClientConfiguration.jsonRequest is enabled, which requires'\n                            + ' the \"OData-Version\" header to be 3.0 or 4.0');\n                    }\n                }\n            }\n        }\n        if (configuration.jsonResponse) {\n            if (!headers.has('Accept')) {\n                if (oDataVersion === ODataVersion_1.default.v3) {\n                    headers.append('Accept', 'application/json');\n                }\n                else if (oDataVersion === ODataVersion_1.default.v4) {\n                    headers.append('Accept', 'application/json;odata.metadata=minimal');\n                }\n                else {\n                    throw new Error('ISPHttpClientConfiguration.jsonResponse is enabled, which requires'\n                        + ' the \"OData-Version\" header to be 3.0 or 4.0');\n                }\n            }\n        }\n    };\n    SPHttpClientHelper.handleAuthenticationErrors = function (promise, webUrl, digestCache) {\n        return promise.then(function (response) {\n            if (response.status === 403) {\n                digestCache.clearDigest(webUrl);\n            }\n            return response;\n        });\n    };\n    return SPHttpClientHelper;\n}(HttpClientHelper_1.default));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPHttpClientHelper;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/spHttpClient/SPHttpClientHelper.js\n// module id = 19\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar decorators_1 = require(\"@microsoft/decorators\");\nvar SPHttpClientCommonConfiguration_1 = require(\"./SPHttpClientCommonConfiguration\");\nvar HttpClient_1 = require(\"../httpClient/HttpClient\");\nvar SPHttpClientBatchConfiguration = (function (_super) {\n    __extends(SPHttpClientBatchConfiguration, _super);\n    function SPHttpClientBatchConfiguration(flags, overrideFlags) {\n        return _super.call(this, flags, overrideFlags) || this;\n    }\n    SPHttpClientBatchConfiguration.prototype.initializeFlags = function () {\n        _super.prototype.initializeFlags.call(this);\n    };\n    SPHttpClientBatchConfiguration.prototype.overrideWith = function (sourceFlags) {\n        return new SPHttpClientBatchConfiguration(this.flags, sourceFlags);\n    };\n    return SPHttpClientBatchConfiguration;\n}(SPHttpClientCommonConfiguration_1.default));\n__decorate([\n    decorators_1.override\n], SPHttpClientBatchConfiguration.prototype, \"initializeFlags\", null);\n__decorate([\n    decorators_1.override\n], SPHttpClientBatchConfiguration.prototype, \"overrideWith\", null);\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPHttpClientBatchConfiguration;\nexports.predefinedConfigurations = {\n    v1: new SPHttpClientBatchConfiguration(HttpClient_1.default.configurations.v1, {\n        jsonRequest: true,\n        jsonResponse: true\n    })\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/spHttpClient/SPHttpClientBatchConfiguration.js\n// module id = 20\n// module chunks = 0","\"use strict\";\nvar sp_client_shared_1 = require(\"@ms/sp-client-shared\");\nvar OAuthUtilityContext_1 = require(\"./OAuthUtilityContext\");\nvar sp_core_library_1 = require(\"@microsoft/sp-core-library\");\nvar OAuthTokenProvider = (function () {\n    function OAuthTokenProvider(serviceScope) {\n        this._tokenUtility = new sp_client_shared_1.OAuthUtility(new OAuthUtilityContext_1.default(serviceScope));\n    }\n    OAuthTokenProvider.prototype.getOAuthToken = function (resource, webUrl) {\n        sp_core_library_1.Validate.isNotNullOrUndefined(resource, 'resource');\n        sp_core_library_1.Validate.isNonemptyString(resource, 'resource');\n        return this._tokenUtility.getOAuthToken(resource, webUrl);\n    };\n    OAuthTokenProvider.prototype.clearCachedToken = function (resource) {\n        sp_core_library_1.Validate.isNotNullOrUndefined(resource, 'resource');\n        sp_core_library_1.Validate.isNonemptyString(resource, 'resource');\n        this._tokenUtility.clearCachedToken(resource);\n    };\n    return OAuthTokenProvider;\n}());\nOAuthTokenProvider.serviceKey = sp_core_library_1.ServiceKey.create('sp-client-shared:OAuthTokenProvider', OAuthTokenProvider);\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = OAuthTokenProvider;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/oauthTokenProvider/OAuthTokenProvider.js\n// module id = 21\n// module chunks = 0","\"use strict\";\nvar OAuthUtility_1 = require(\"./tokenUtility/OAuthUtility\");\nexports.OAuthUtility = OAuthUtility_1.default;\nvar OAuthUtilityError_1 = require(\"./tokenUtility/OAuthUtilityError\");\nexports.OAuthUtilityError = OAuthUtilityError_1.default;\nexports.OAuthUtilityErrorType = OAuthUtilityError_1.OAuthUtilityErrorType;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/code/sp-client/libraries/sp-client-shared/lib/index.js\n// module id = 22\n// module chunks = 0","\"use strict\";\nvar Constants_1 = require(\"./Constants\");\nvar OAuthUtilityError_1 = require(\"./OAuthUtilityError\");\nvar OAuthUtility = (function () {\n    function OAuthUtility(context) {\n        this._context = context;\n        this._dispose = this._dispose.bind(this);\n        window.addEventListener('unload', this._dispose);\n    }\n    OAuthUtility._getCorrelationId = function (response) {\n        return response.headers.get('sprequestguid');\n    };\n    OAuthUtility._extractRealError = function (errorResponse) {\n        var isNested = errorResponse.hasOwnProperty('error');\n        return isNested ? errorResponse.error : errorResponse;\n    };\n    OAuthUtility.prototype.getOAuthToken = function (resource, webUrl) {\n        var _this = this;\n        var cachedData = this._getCachedTokenData(resource);\n        if (cachedData && !this._isExpiring(cachedData)) {\n            return Promise.resolve({\n                token: cachedData.accessToken,\n                isGuest: false\n            });\n        }\n        return this._retriableFetchWithDigest(resource, Constants_1.default.retries, webUrl)\n            .then(function (responseData) {\n            _this._storeTokenData(resource, responseData);\n            return {\n                token: responseData.accessToken,\n                isGuest: false\n            };\n        });\n    };\n    OAuthUtility.prototype.clearCachedToken = function (resource) {\n        var key = this._getCacheKey(resource);\n        window.sessionStorage.removeItem(key);\n        var index = this._resourceKeys.indexOf(key);\n        if (!isNaN(index) && index > -1) {\n            this._resourceKeys.splice(index);\n        }\n    };\n    Object.defineProperty(OAuthUtility.prototype, \"_resourceKeys\", {\n        get: function () {\n            if (!this._keysToDispose) {\n                this._keysToDispose = new Array();\n            }\n            return this._keysToDispose;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    OAuthUtility.prototype._retriableFetchWithDigest = function (resource, retriesLeft, webUrl) {\n        var _this = this;\n        var monitor = this._context.qosMonitor();\n        return this._context.fetchWithDigest(this._buildTokenRequest(resource, webUrl))\n            .then(function (response) {\n            if (response.status !== 200) {\n                _this._context.logger.logError('fetchWithDigest failed. Server responded with ' + response.statusText);\n                var error = new OAuthUtilityError_1.default(OAuthUtilityError_1.OAuthUtilityErrorType.unknownError, {\n                    httpResponseStatus: response.status,\n                    message: response.statusText,\n                    correlationId: OAuthUtility._getCorrelationId(response)\n                });\n                if (response.status !== 400) {\n                    monitor.writeUnexpectedFailure('UnknownError', error);\n                    return Promise.reject(error);\n                }\n                return response.json().then(function (mixedErrorResponse) {\n                    var errorResponse = OAuthUtility._extractRealError(mixedErrorResponse);\n                    var errorCode = _this._getErrorCodeFromResponseCode(errorResponse);\n                    if (!_this._isRetriableError(errorCode) || (retriesLeft === 0)) {\n                        var error_1 = _this._buildErrorFromResponse(errorResponse);\n                        monitor.writeUnexpectedFailure('SharepointServerError', error_1);\n                        return Promise.reject(error_1);\n                    }\n                    _this._context.logger.logError('fetchWithDigest failed. Retrying. Retries left: ' + retriesLeft);\n                    return _this._retriableFetchWithDigest(resource, retriesLeft - 1, webUrl);\n                });\n            }\n            return _this._instrumentedParseResponseData(response, monitor);\n        });\n    };\n    OAuthUtility.prototype._getCachedTokenData = function (resource) {\n        return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(resource)));\n    };\n    OAuthUtility.prototype._storeTokenData = function (resource, data) {\n        window.sessionStorage.setItem(this._getCacheKey(resource), JSON.stringify(data));\n    };\n    OAuthUtility.prototype._getCacheKey = function (resource) {\n        var key = ['sp-client-shared', Constants_1.default.npmPackageVersion, 'OAuthUtility', resource].join(';');\n        var index = this._resourceKeys.indexOf(key);\n        if (index === -1) {\n            this._resourceKeys.push(key);\n        }\n        return key;\n    };\n    OAuthUtility.prototype._isExpiring = function (tokenRequestData) {\n        return (tokenRequestData.expiresOn - Date.now() / 1000) < Constants_1.default.aboutToExpireIntervalSeconds;\n    };\n    OAuthUtility.prototype._isRetriableError = function (errorCode) {\n        return Constants_1.default.retriableErrorCodes.indexOf(errorCode) !== -1;\n    };\n    OAuthUtility.prototype._buildTokenRequest = function (resource, webUrl) {\n        var requestHeaders = new Headers();\n        requestHeaders.append('Content-Type', 'application/json; charset=utf-8');\n        requestHeaders.append('Odata-Version', '4.0');\n        requestHeaders.append('Accept', 'application/json;odata.metadata=minimal');\n        var request = {\n            method: 'POST',\n            headers: requestHeaders,\n            body: JSON.stringify(this._buildRequestBody(resource))\n        };\n        var webUrlNoEndingSlash = webUrl;\n        if (webUrlNoEndingSlash && webUrlNoEndingSlash.lastIndexOf('/') === webUrlNoEndingSlash.length - 1) {\n            webUrlNoEndingSlash = webUrlNoEndingSlash.substr(0, webUrlNoEndingSlash.length - 1);\n        }\n        return new Request(webUrlNoEndingSlash + Constants_1.default.apiUrl, request);\n    };\n    OAuthUtility.prototype._buildRequestBody = function (resource) {\n        return {\n            resource: resource\n        };\n    };\n    OAuthUtility.prototype._buildErrorFromResponse = function (serverErrorResponse) {\n        var errorCode = this._getErrorCodeFromResponseCode(serverErrorResponse);\n        if (errorCode === undefined) {\n            return new OAuthUtilityError_1.default(OAuthUtilityError_1.OAuthUtilityErrorType.malformedResponseBody, {\n                httpResponseStatus: 400,\n                message: Constants_1.default.unexpectedErrorCodeFormat,\n                correlationId: serverErrorResponse.correlationId\n            });\n        }\n        var message;\n        var cultureName;\n        if (serverErrorResponse.message) {\n            if (typeof serverErrorResponse.message === 'string') {\n                message = serverErrorResponse.message;\n            }\n            else {\n                message = serverErrorResponse.message.value;\n                cultureName = serverErrorResponse.message.lang;\n            }\n        }\n        var redirectUrlKey = 'error.redirectUrl';\n        return new OAuthUtilityError_1.default(OAuthUtilityError_1.OAuthUtilityErrorType.serverError, {\n            httpResponseStatus: 400,\n            message: message,\n            cultureName: cultureName,\n            serverErrorCode: errorCode,\n            correlationId: serverErrorResponse.correlationId,\n            redirectUrl: serverErrorResponse[redirectUrlKey] || serverErrorResponse[\"@\" + redirectUrlKey]\n        });\n    };\n    OAuthUtility.prototype._getErrorCodeFromResponseCode = function (serverErrorResponse) {\n        var responseErrorCode = serverErrorResponse.code;\n        var errorCode = Number(responseErrorCode);\n        if (isNaN(errorCode) && typeof serverErrorResponse.message === 'string') {\n            var firstCommaIndex = responseErrorCode.indexOf(',');\n            if (firstCommaIndex !== -1) {\n                errorCode = Number(responseErrorCode.substr(0, firstCommaIndex));\n            }\n        }\n        return errorCode;\n    };\n    OAuthUtility.prototype._instrumentedParseResponseData = function (response, monitor) {\n        try {\n            return response.json().then(function (responseBody) {\n                monitor.writeSuccess();\n                return {\n                    accessToken: responseBody.access_token,\n                    expiresOn: Number(responseBody.expires_on),\n                    notBefore: Number(responseBody.not_before),\n                    resource: responseBody.resource,\n                    tokenType: responseBody.token_type\n                };\n            });\n        }\n        catch (error) {\n            monitor.writeUnexpectedFailure('ResponseParseError', error);\n            return Promise.reject(new OAuthUtilityError_1.default(OAuthUtilityError_1.OAuthUtilityErrorType.malformedResponseBody, {\n                httpResponseStatus: 200,\n                message: Constants_1.default.unexpectedTokenMessageFormat,\n                correlationId: OAuthUtility._getCorrelationId(response)\n            }));\n        }\n    };\n    OAuthUtility.prototype._dispose = function (ev) {\n        window.removeEventListener('unload', this._dispose);\n        for (var _i = 0, _a = this._resourceKeys; _i < _a.length; _i++) {\n            var key = _a[_i];\n            window.sessionStorage.removeItem(key);\n        }\n    };\n    return OAuthUtility;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = OAuthUtility;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/code/sp-client/libraries/sp-client-shared/lib/tokenUtility/OAuthUtility.js\n// module id = 23\n// module chunks = 0","\"use strict\";\nvar Constants = (function () {\n    function Constants() {\n    }\n    return Constants;\n}());\nConstants.tokenCacheSessionStorageId = 'tokenCache';\nConstants.aboutToExpireIntervalSeconds = 600;\nConstants.apiUrl = '/_api/SP.OAuth.Token/Acquire';\nConstants.retries = 3;\nConstants.retriableErrorCodes = [\n    10006,\n    10008\n];\nConstants.unexpectedErrorCodeFormat = 'Expected error code format is <numericCode>, <exception class name>';\nConstants.unexpectedTokenMessageFormat = 'Your token request succeedeed but the token could not be parsed from the response.' +\n    'This is most probably caused by a change in the server response format';\nConstants.npmPackageVersion = '0.1.5';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Constants;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/code/sp-client/libraries/sp-client-shared/lib/tokenUtility/Constants.js\n// module id = 24\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar OAuthUtilityError = (function (_super) {\n    __extends(OAuthUtilityError, _super);\n    function OAuthUtilityError(type, context) {\n        var _this = _super.call(this, context.message) || this;\n        _this.__proto__ = OAuthUtilityError.prototype; \n        _this._type = type;\n        _this._httpResponseStatus = context.httpResponseStatus;\n        _this._cultureName = context.cultureName;\n        _this._message = context.message;\n        _this._serverErrorCode = context.serverErrorCode;\n        _this._correlationId = context.correlationId;\n        _this._redirectUrl = context.redirectUrl;\n        return _this;\n    }\n    Object.defineProperty(OAuthUtilityError.prototype, \"type\", {\n        get: function () {\n            return this._type;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(OAuthUtilityError.prototype, \"serverErrorCode\", {\n        get: function () {\n            if (this.type !== OAuthUtilityErrorType.serverError) {\n                throw new Error('ServerErrorCode can only be obtained for errors of type serverError');\n            }\n            return this._serverErrorCode;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(OAuthUtilityError.prototype, \"httpResponseStatus\", {\n        get: function () {\n            return this._httpResponseStatus;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(OAuthUtilityError.prototype, \"message\", {\n        get: function () {\n            return this._message;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(OAuthUtilityError.prototype, \"cultureName\", {\n        get: function () {\n            return this._cultureName;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(OAuthUtilityError.prototype, \"correlationId\", {\n        get: function () {\n            return this._correlationId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(OAuthUtilityError.prototype, \"redirectUrl\", {\n        get: function () {\n            return this._redirectUrl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return OAuthUtilityError;\n}(Error));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = OAuthUtilityError;\nvar OAuthUtilityErrorType;\n(function (OAuthUtilityErrorType) {\n    OAuthUtilityErrorType[OAuthUtilityErrorType[\"unknownError\"] = 0] = \"unknownError\";\n    OAuthUtilityErrorType[OAuthUtilityErrorType[\"malformedResponseBody\"] = 1] = \"malformedResponseBody\";\n    OAuthUtilityErrorType[OAuthUtilityErrorType[\"serverError\"] = 2] = \"serverError\";\n})(OAuthUtilityErrorType = exports.OAuthUtilityErrorType || (exports.OAuthUtilityErrorType = {}));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/code/sp-client/libraries/sp-client-shared/lib/tokenUtility/OAuthUtilityError.js\n// module id = 25\n// module chunks = 0","\"use strict\";\nvar sp_telemetry_1 = require(\"@ms/sp-telemetry\");\nvar SPHttpClient_1 = require(\"../spHttpClient/SPHttpClient\");\nvar TokenUtilityLogger = (function () {\n    function TokenUtilityLogger() {\n    }\n    TokenUtilityLogger.prototype.logInfo = function (message) {\n        sp_telemetry_1._TraceLogger.logVerbose(TokenUtilityLogger.logSource, message);\n    };\n    TokenUtilityLogger.prototype.logError = function (message) {\n        sp_telemetry_1._TraceLogger.logError(TokenUtilityLogger.logSource, new Error(message));\n    };\n    TokenUtilityLogger.prototype.logWarning = function (message) {\n        sp_telemetry_1._TraceLogger.logVerbose(TokenUtilityLogger.logSource, 'Warning: ' + message);\n    };\n    return TokenUtilityLogger;\n}());\nTokenUtilityLogger.logSource = sp_telemetry_1._LogSource.create('TokenUtility');\nvar OAuthUtilityContext = (function () {\n    function OAuthUtilityContext(serviceScope) {\n        var _this = this;\n        serviceScope.whenFinished(function () {\n            _this._spHttpClient = serviceScope.consume(SPHttpClient_1.default.serviceKey);\n            _this._logger = new TokenUtilityLogger();\n        });\n    }\n    Object.defineProperty(OAuthUtilityContext.prototype, \"logger\", {\n        get: function () {\n            return this._logger;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(OAuthUtilityContext.prototype, \"webUrl\", {\n        get: function () {\n            return '';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    OAuthUtilityContext.prototype.fetchWithDigest = function (request) {\n        var _this = this;\n        return request.blob().then(function (requestBody) {\n            return _this._spHttpClient.fetch(request.url, SPHttpClient_1.default.configurations.v1, {\n                method: request.method,\n                headers: request.headers,\n                body: requestBody\n            });\n        });\n    };\n    OAuthUtilityContext.prototype.qosMonitor = function () {\n        return new sp_telemetry_1._QosMonitor(OAuthUtilityContext.qosName);\n    };\n    return OAuthUtilityContext;\n}());\nOAuthUtilityContext.qosName = 'OAuthTokenProvider';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = OAuthUtilityContext;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/oauthTokenProvider/OAuthUtilityContext.js\n// module id = 26\n// module chunks = 0"],"sourceRoot":""}