"use strict";
var chai_1 = require("chai");
var sp_core_library_1 = require("@microsoft/sp-core-library");
var HttpClient_1 = require("../HttpClient");
var MockFetchProvider_1 = require("../../test/MockFetchProvider");
var FetchProvider_1 = require("../FetchProvider");
describe('HttpClient tests', function () {
    describe('Test simple requests', function () {
        var rootScope = sp_core_library_1.ServiceScope.startNewRoot();
        var fetchProvider = new MockFetchProvider_1.default(rootScope);
        rootScope.provide(FetchProvider_1.fetchProviderServiceKey, fetchProvider);
        rootScope.finish();
        var httpClient = new HttpClient_1.default(rootScope);
        it('should NOT add headers for a basic GET request', function (done) {
            fetchProvider.expect({
                expectedUrl: 'http://example.com/_api/test01',
                requestAssertions: function (request) {
                    var headerCount = 0;
                    request.headers.forEach(function (value, name) { ++headerCount; });
                    chai_1.assert.equal(headerCount, 0);
                },
                responseObject: { 'data': 123 }
            });
            httpClient.get('http://example.com/_api/test01', HttpClient_1.default.configurations.v1)
                .then(function (response) {
                return response.json();
            }).then(function (responseObject) {
                chai_1.assert.equal(responseObject.data, 123);
                done();
            }).catch(function (error) {
                done(error);
            });
        });
    });
});
