"use strict";
var fs = require('fs');
var path = require('path');
var rootDir = process.cwd();
function enableCORS(req, res) {
    'use strict';
    res.set('Access-Control-Allow-Origin', req.headers.origin);
    res.set('Access-Control-Allow-Credentials', 'true');
}
function getPublic(req, res) {
    'use strict';
    var parts = req.originalUrl.split('.');
    var ext;
    var filePath = path.join(rootDir, 'dist/public' + req.originalUrl);
    if (parts.length > 1) {
        ext = parts[parts.length - 1];
    }
    else {
        ext = 'json';
        filePath += '.json';
    }
    var stat = fs.statSync(filePath); 
    enableCORS(req, res);
    var contentType;
    switch (ext) {
        case 'hbs':
            contentType = 'text/x-handlebars-template';
            break;
        case 'json':
            contentType = 'application/json';
            break;
        case 'htm':
        case 'html':
            contentType = 'text/html';
            break;
        case 'md':
            contentType = 'text/x-markdown-template';
            break;
        case 'mst':
            contentType = 'text/x-mustache-template';
            break;
        case 'png':
            contentType = 'image/png';
            break;
    }
    res.writeHead(200, {
        'Content-Type': contentType,
        'Content-Length': stat.size,
        'Cache-Control': 'public, max-age=1440' 
    });
    var rs = fs.createReadStream(filePath); 
    rs.pipe(res);
}
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = getPublic;
