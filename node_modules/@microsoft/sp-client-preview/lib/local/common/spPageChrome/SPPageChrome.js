"use strict";
var SPThemeProvider_1 = require("./SPThemeProvider");
var sp_core_library_1 = require("@microsoft/sp-core-library");
var SPGlobalErrorHandler_1 = require("../error/SPGlobalErrorHandler");
require("./SPPageChrome.scss");
var SPPageChrome = (function () {
    function SPPageChrome(serviceScope) {
        this._createPageChrome();
        if (!sp_core_library_1._SPKillSwitch.isActivated(sp_core_library_1.Guid.tryParse('48CB5A9D-4E94-40F0-B51F-24480C28E565'), '7/13/2016', 'EnableTheming')) {
            this._spThemeProvider = new SPThemeProvider_1.default(serviceScope);
            this._spThemeProvider.loadThemedStyles();
        }
    }
    SPPageChrome.getInstance = function (serviceScope) {
        if (SPPageChrome._instance === undefined) {
            SPPageChrome._instance = new SPPageChrome(serviceScope);
        }
        return SPPageChrome._instance;
    };
    SPPageChrome.prototype.changeSuiteNavHeight = function (pixels) {
        var top = parseInt(pixels, 10) + 'px';
        this.appDiv.style.top = top;
        this.appDiv.style.height = "calc(100% - " + top + ")";
        this.propertyPaneContainerDiv.style.top = top;
        this.suiteNavDiv.style.height = top;
    };
    SPPageChrome.prototype._createPageChrome = function () {
        document.body.className = 'ms-font-m';
        var pageChromeDiv = document.createElement('div');
        pageChromeDiv.setAttribute('class', 'SPPageChrome');
        this.suiteNavDiv = document.createElement('div');
        this.suiteNavDiv.setAttribute('id', 'SuiteNavPlaceHolder');
        this.appDiv = document.createElement('div');
        this.appDiv.setAttribute('class', 'SPPageChrome-app spPageContentTransition');
        this.appDiv.setAttribute('id', 'spPageChromeAppDiv');
        this.propertyPaneContainerDiv = document.createElement('div');
        this.propertyPaneContainerDiv.setAttribute('class', 'spPropertyPaneContainer spPageContentTransition');
        this.propertyPaneContainerDiv.setAttribute('id', 'spPropertyPaneContainer');
        pageChromeDiv.appendChild(this.suiteNavDiv);
        pageChromeDiv.appendChild(this.appDiv);
        pageChromeDiv.appendChild(this.propertyPaneContainerDiv);
        document.body.appendChild(pageChromeDiv);
        if (this._shouldHandleGlobalErrors && !window.onerror) {
            window.onerror = SPGlobalErrorHandler_1.default.basicTracingHandler;
        }
    };
    Object.defineProperty(SPPageChrome.prototype, "_shouldHandleGlobalErrors", {
        get: function () {
            return !sp_core_library_1._SPKillSwitch.isActivated(sp_core_library_1.Guid.tryParse('BAC66CD5-F1C1-4BDD-9FFD-A8C6044EB285'), '10/13/2016', 'GlobalErrorHandler');
        },
        enumerable: true,
        configurable: true
    });
    return SPPageChrome;
}());
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = SPPageChrome;
