"use strict";
var React = require("react");
var enzyme_1 = require("enzyme");
var chai_1 = require("chai");
var WebPartForm_1 = require("../../components/webpartForm/WebPartForm");
describe('WebPartForm', function () {
    var handleKeyDown = sinon.spy(function (evt) { });
    var handleSubmit = sinon.spy(function (evt) { });
    var webpartForm;
    var mockProps;
    beforeEach(function () {
        mockProps = {
            isClassicSharePointPage: true,
            onKeyDown: handleKeyDown,
            onSubmit: handleSubmit
        };
    });
    afterEach(function () {
        webpartForm.unmount();
    });
    it('should call onSubmit after press enter in classic sharepoint page', function (done) {
        webpartForm = enzyme_1.mount(React.createElement(WebPartForm_1.default, mockProps, React.createElement('button')));
        chai_1.expect(webpartForm.find('form')).to.have.length(0);
        webpartForm.find('button').simulate('keyDown', { keyCode: 13 });
        chai_1.expect(handleSubmit.called).to.be.true;
        chai_1.expect(handleKeyDown.called).to.be.true;
        done();
    });
    it('should call onSubmit after submit button is clicked in classic sharepoint page', function (done) {
        webpartForm = enzyme_1.mount(React.createElement(WebPartForm_1.default, mockProps, React.createElement('input', { type: 'submit' })));
        chai_1.expect(webpartForm.find('form')).to.have.length(0);
        webpartForm.find('input').simulate('click');
        chai_1.expect(handleSubmit.called).to.be.true;
        done();
    });
    it('should call onSubmit after press enter in modern sharepoint page', function (done) {
        mockProps.isClassicSharePointPage = false;
        webpartForm = enzyme_1.mount(React.createElement(WebPartForm_1.default, mockProps, React.createElement('input', { type: 'submit' })));
        chai_1.expect(webpartForm.find('form')).to.have.length(1);
        webpartForm.find('input').simulate('keyDown', { keyCode: 13 });
        chai_1.expect(handleSubmit.called).to.be.true;
        chai_1.expect(handleKeyDown.called).to.be.true;
        done();
    });
    it('should call onSubmit after submit button is clicked in modern sharepoint page', function (done) {
        mockProps.isClassicSharePointPage = false;
        webpartForm = enzyme_1.mount(React.createElement(WebPartForm_1.default, mockProps, React.createElement('button')));
        chai_1.expect(webpartForm.find('form')).to.have.length(1);
        webpartForm.find('button').simulate('click');
        chai_1.expect(handleSubmit.called).to.be.true;
        done();
    });
});
